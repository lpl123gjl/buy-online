{"ast":null,"code":"import \"core-js/modules/es.array.push.js\";\nimport Vue from 'vue';\nimport VueRouter from 'vue-router';\nimport Login from '@/views/Login.vue';\nimport Home from '@/views/Home.vue';\nimport NotFound from '@/views/NotFound.vue';\nimport axios from '@/api/index.js';\nimport store from '@/store';\nVue.use(VueRouter);\nconst routes = [{\n  path: '/',\n  name: 'home',\n  component: Home,\n  children: [{\n    path: '/index',\n    name: 'Index',\n    meta: {\n      title: '首页',\n      icon: 'el-icon-s-home'\n    },\n    component: () => import(\"@/views/Index.vue\")\n  }, {\n    path: '/setpwd',\n    name: 'setpwd',\n    meta: {\n      title: '修改密码',\n      icon: 'el-icon-lock'\n    },\n    component: () => import(\"@/views/SetPwd.vue\")\n  }]\n}, {\n  path: '/login',\n  name: 'login',\n  component: Login\n}, {\n  path: '/notfound',\n  name: 'NotFound',\n  component: NotFound\n}];\nconst router = new VueRouter({\n  routes\n});\n\n//设置路由守卫\nrouter.beforeEach((to, from, next) => {\n  //菜单和路由是否配置加载过\n  let hasRoute = store.state.menus.hasRoute;\n  let menus = store.state.menus.menuList;\n  //路由守卫会拦截所有路由跳转，需要对跳转路径进行过滤。\n  if (to.path == '/login') {\n    next(); //如果是跳转是登录页面，就放行\n  } else if (to.path == '/' || to.path == '') {\n    next('/index');\n  } else if (!hasRoute) {\n    //hasRoute是false，表示第一次加载和配置菜单和路由\n    let JSONRoutes = router.options.routes;\n    console.log(\"加载和配置菜单路由---\");\n    axios.get('/menu/nav').then(response => {\n      //使用vuex调用SET_MENULIST的方法存储菜单:\n      console.log('222', response.data.resultdata.nav);\n      store.commit('SET_MENULIST', response.data.resultdata.nav);\n      store.commit('SET_PERMLIST', response.data.resultdata.authoritys);\n      //修改hasRoute将设置True，表示已经加载配置过菜单\n      store.commit('SET_HASROUTE', true);\n      response.data.resultdata.nav.forEach(menu => {\n        if (menu.children) {\n          menu.children.forEach(child => {\n            let route = menuToRoute(child);\n            if (route) {\n              JSONRoutes[0].children.push(route);\n            }\n          });\n        }\n      });\n      router.matcher = new VueRouter().matcher;\n      router.addRoutes(JSONRoutes);\n      next({\n        path: to.path\n      });\n    }).catch(e => {\n      console.log(e);\n    });\n  } else {\n    console.log(\"菜单和路由配置加载过了---\");\n    next();\n  }\n});\nconst menuToRoute = child => {\n  if (!child.component) {\n    return null;\n  }\n  let route = {\n    path: child.path,\n    name: child.name,\n    meta: {\n      icon: child.icon,\n      title: child.title\n    }\n  };\n  route.component = () => import(\"@/views/\" + child.component + \".vue\");\n  return route;\n};\nexport default router;","map":{"version":3,"names":["Vue","VueRouter","Login","Home","NotFound","axios","store","use","routes","path","name","component","children","meta","title","icon","router","beforeEach","to","from","next","hasRoute","state","menus","menuList","JSONRoutes","options","console","log","get","then","response","data","resultdata","nav","commit","authoritys","forEach","menu","child","route","menuToRoute","push","matcher","addRoutes","catch","e"],"sources":["D:/VueProjects/mall-online-system/src/router/index.js"],"sourcesContent":["import Vue from 'vue'\nimport VueRouter from 'vue-router'\nimport Login from '@/views/Login.vue'\nimport Home from '@/views/Home.vue'\nimport NotFound from '@/views/NotFound.vue'\nimport axios from '@/api/index.js'\nimport store from '@/store'\n\n\nVue.use(VueRouter)\n\n\n\nconst routes = [\n  {\n    path: '/',\n    name: 'home',\n    component: Home,\n    children:[\n      {\n        path:'/index',\n        name:'Index',\n        meta:{\n          title:'首页',\n          icon:'el-icon-s-home',\n        },\n        component: ()=> import(\"@/views/Index.vue\")\n      },\n      {\n        path: '/setpwd',\n        name: 'setpwd',\n        meta:{\n          title:'修改密码',\n          icon:'el-icon-lock',\n        },\n        component: ()=> import(\"@/views/SetPwd.vue\")\n      },\n      \n    ]\n  },\n  \n  {\n    path: '/login',\n    name: 'login',\n    component: Login\n  },\n  {\n    path: '/notfound',\n    name: 'NotFound',\n    component: NotFound\n  },\n\n]\n\nconst router = new VueRouter({\n  routes\n})\n\n//设置路由守卫\nrouter.beforeEach((to, from, next) => {\n  //菜单和路由是否配置加载过\n  let hasRoute = store.state.menus.hasRoute\n  let menus = store.state.menus.menuList\n  //路由守卫会拦截所有路由跳转，需要对跳转路径进行过滤。\n  if (to.path == '/login') {\n    next(); //如果是跳转是登录页面，就放行\n  }else if(to.path =='/' || to.path ==''){\n    next('/index')\n  }\n  else if (!hasRoute) { //hasRoute是false，表示第一次加载和配置菜单和路由\n    let JSONRoutes = router.options.routes;\n    console.log(\"加载和配置菜单路由---\");\n    axios.get('/menu/nav').then(response => {\n      //使用vuex调用SET_MENULIST的方法存储菜单:\n      console.log('222',response.data.resultdata.nav);\n      store.commit('SET_MENULIST', response.data.resultdata.nav)\n      store.commit('SET_PERMLIST', response.data.resultdata.authoritys)\n      //修改hasRoute将设置True，表示已经加载配置过菜单\n      store.commit('SET_HASROUTE', true);\n\n      response.data.resultdata.nav.forEach(menu=>{\n        if(menu.children){\n          menu.children.forEach(child=>{\n            let route = menuToRoute(child)\n            if(route){\n              JSONRoutes[0].children.push(route)\n            }\n          })\n        }\n      })\n      \n      router.matcher = new VueRouter().matcher\n      router.addRoutes(JSONRoutes)\n      next({ path: to.path })\n    }).catch(e => { console.log(e); })\n    \n  } else {\n    console.log(\"菜单和路由配置加载过了---\");\n    next();\n  }\n})\n\nconst menuToRoute = (child)=>{\n  if(!child.component){\n    return null\n  }\n  let route = {\n    path: child.path,\n    name: child.name,\n    meta:{\n      icon:child.icon,\n      title:child.title,\n    }\n  }\n  route.component = () => import(\"@/views/\"+child.component+\".vue\");\n  return route;\n}\n\nexport default router\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}