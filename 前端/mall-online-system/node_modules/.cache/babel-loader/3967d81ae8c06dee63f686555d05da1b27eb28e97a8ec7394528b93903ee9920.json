{"ast":null,"code":"export default {\n  data() {\n    return {\n      user: {\n        username: '',\n        avatar: '',\n        email: '',\n        tel: ''\n      },\n      businessIds: [],\n      businessCount: '',\n      userCount: '',\n      accountCount: '',\n      allOrdersCount: '',\n      tableData: [],\n      value: 'count',\n      value2: '',\n      isSelect: true,\n      timeRange: 'ONE_MONTH',\n      options: [{\n        value: 'count',\n        label: '销售量(单)'\n      }, {\n        value: 'sales',\n        label: '销售额(元)'\n      }],\n      isRank: false\n    };\n  },\n  watch: {\n    timeRange(newValue) {\n      this.getRankList(this.value, newValue);\n      setTimeout(() => {\n        this.$refs.table.doLayout(); // 手动重新渲染table\n      }, 0);\n    }\n  },\n  created() {\n    this.getUserInfo();\n    if (this.businessIds.length == 0) {\n      this.getRankList(this.value, this.timeRange);\n    }\n    this.getBusinessCount();\n    this.getAccountCount();\n    this.getUserCount();\n    this.getAllOrdersCount();\n  },\n  methods: {\n    getUserInfo() {\n      //请求服务器获得\n      this.$axios.get('/api/userinfo').then(response => {\n        this.user = response.data.resultdata;\n        if (response.data.resultdata.business.length > 0) {\n          this.businessIds = response.data.resultdata.business;\n          this.value2 = this.businessIds[0].businessId;\n          this.getRankGoods(this.value2);\n          this.businessIds.forEach((b, index) => {\n            this.options[index] = {\n              value2: b.businessId,\n              label: b.businessId\n            };\n          });\n        }\n      }).catch(e => {\n        console.log(e);\n      });\n    },\n    getBusinessCount() {\n      this.$axios.get('/business/count').then(response => {\n        this.businessCount = response.data.resultdata;\n      }).catch(e => {\n        console.log(e);\n      });\n    },\n    getUserCount() {\n      this.$axios.get('/user/count').then(response => {\n        this.userCount = response.data.resultdata;\n      }).catch(e => {\n        console.log(e);\n      });\n    },\n    getAccountCount() {\n      this.$axios.get('/account/count').then(response => {\n        this.accountCount = response.data.resultdata;\n      }).catch(e => {\n        console.log(e);\n      });\n    },\n    getAllOrdersCount() {\n      this.$axios.get('/orders/allcount').then(response => {\n        this.allOrdersCount = response.data.resultdata;\n      }).catch(e => {\n        console.log(e);\n      });\n    },\n    getRankGoods(id) {\n      this.$axios.get('/orders/rank/' + id).then(response => {\n        this.tableData = response.data.resultdata.map((item, index) => {\n          return {\n            goodsId: item.goodsId,\n            goodsName: item.goodsName,\n            quantity: item.quantity,\n            sales: item.sales,\n            rank: index + 1\n          };\n        });\n        this.$forceUpdate();\n      }).catch(e => {\n        console.log(e);\n      });\n    },\n    getRankList(val, timeRange) {\n      if (val == \"count\") {\n        this.isSelect = true;\n      }\n      if (val == \"sales\") {\n        this.isSelect = false;\n      }\n      this.$axios.get('/orders/' + val + '/' + timeRange).then(response => {\n        this.tableData = response.data.resultdata.map((item, index) => {\n          return {\n            created: item.created,\n            businessName: item.businessName,\n            businessExplain: item.businessExplain,\n            ordersCount: item.ordersCount,\n            sales: item.sales,\n            rank: index + 1\n          };\n        });\n        this.$forceUpdate();\n      }).catch(e => {\n        console.log(e);\n      });\n    },\n    formatDate(row, column) {\n      return new Date(row.created).toLocaleDateString();\n    }\n  }\n};","map":{"version":3,"names":["data","user","username","avatar","email","tel","businessIds","businessCount","userCount","accountCount","allOrdersCount","tableData","value","value2","isSelect","timeRange","options","label","isRank","watch","newValue","getRankList","setTimeout","$refs","table","doLayout","created","getUserInfo","length","getBusinessCount","getAccountCount","getUserCount","getAllOrdersCount","methods","$axios","get","then","response","resultdata","business","businessId","getRankGoods","forEach","b","index","catch","e","console","log","id","map","item","goodsId","goodsName","quantity","sales","rank","$forceUpdate","val","businessName","businessExplain","ordersCount","formatDate","row","column","Date","toLocaleDateString"],"sources":["src/views/Index.vue"],"sourcesContent":["<template>\r\n  <div class=\"page\" style=\"margin: 0 15px;\">\r\n    <el-container>\r\n      <el-aside width=\"450px\" style=\"overflow: hidden;margin-right: 20px;\">\r\n        <el-row :gutter=\"10\">\r\n          <el-col :span=\"24\">\r\n            <div class=\"grid-content bg-purple top\">\r\n              <div style=\"display: flex;align-items: center;height: 100%;\">\r\n                <img :src=\"user.avatar\">\r\n                <div class=\"userInfo\" style=\"display: flex;flex-direction: column;\">\r\n                  <div><span style=\"margin-right: 70px;\">用户名：</span><span>{{ user.username }}</span></div>\r\n                  <div><span style=\"margin-right: 70px;\">邮箱：</span><span>{{ user.email }}</span></div>\r\n                  <div><span style=\"margin-right: 70px;\">联系电话：</span><span>{{ user.tel }}</span></div>\r\n                  <div><span style=\"margin-right: 70px;\">绑定商家：</span><span>商家</span></div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </el-col>\r\n        </el-row>\r\n      </el-aside>\r\n      <el-main>\r\n        <el-row :gutter=\"10\">\r\n          <el-col :span=\"12\">\r\n            <div class=\"grid-content bg-purple content right\">\r\n              <div>\r\n                <span class=\"num\"><strong>{{ businessCount }}</strong></span>\r\n                <span class=\"text\">已入驻商家数</span>\r\n              </div>\r\n            </div>\r\n          </el-col>\r\n          <el-col :span=\"12\">\r\n            <div class=\"grid-content bg-purple content right\">\r\n              <div>\r\n                <span class=\"num\"><strong>{{ accountCount }}</strong></span>\r\n                <span class=\"text\">平台用户数</span>\r\n              </div>\r\n            </div>\r\n          </el-col>\r\n\r\n        </el-row>\r\n        <el-row :gutter=\"10\">\r\n          <el-col :span=\"12\">\r\n            <div class=\"grid-content bg-purple content right\">\r\n              <div>\r\n                <span class=\"num\"><strong>{{ userCount }}</strong></span>\r\n                <span class=\"text\">管理员数</span>\r\n              </div>\r\n            </div>\r\n          </el-col>\r\n          <el-col :span=\"12\">\r\n            <div class=\"grid-content bg-purple content right\">\r\n              <div>\r\n                <span class=\"num\"><strong>{{ allOrdersCount }}</strong></span>\r\n                <span class=\"text\">平台成交订单数</span>\r\n              </div>\r\n            </div>\r\n          </el-col>\r\n\r\n        </el-row>\r\n\r\n      </el-main>\r\n    </el-container>\r\n\r\n\r\n\r\n\r\n    <el-row :gutter=\"20\">\r\n      <el-col :span=\"24\">\r\n        <div class=\"grid-content bg-purple bottom\" v-if=\"hasAuth('sys:orders:all')\">\r\n          <div class=\"select\">\r\n            <span style=\"font-size: 20px;margin-right: 200px;\"><strong>商家热度排行榜</strong></span>\r\n            <el-radio-group v-model=\"timeRange\" style=\"margin-bottom: 30px;\">\r\n            <el-radio-button label=\"ONE_YEAR\">一年内</el-radio-button>\r\n            <el-radio-button label=\"ONE_MONTH\">本月</el-radio-button>\r\n          </el-radio-group>\r\n          <el-select v-model=\"value\" placeholder=\"请选择\" @change=\"getRankList(value)\">\r\n            <el-option v-for=\"item in options\" :key=\"item.value\" :label=\"item.label\" :value=\"item.value\">\r\n            </el-option>\r\n          </el-select>\r\n          </div>\r\n          <div style=\"padding:20px 30px;box-sizing:border-box\">\r\n            <el-table :data=\"tableData\" style=\"width: 100%;\" ref=\"table\">\r\n              <el-table-column prop=\"rank\" label=\"排行\" width=\"100\" align=\"center\">\r\n              </el-table-column>\r\n              <el-table-column prop=\"created\" label=\"入驻日期\" width=\"250\" align=\"center\" :formatter=\"formatDate\">\r\n              </el-table-column>\r\n              <el-table-column prop=\"businessName\" label=\"商家名称\" width=\"250\" align=\"center\">\r\n              </el-table-column>\r\n              <el-table-column prop=\"businessExplain\" label=\"商家描述\" width=\"200\" align=\"center\">\r\n              </el-table-column>\r\n              <el-table-column prop=\"ordersCount\" label=\"成交订单数(单)\" align=\"center\" v-if=\"isSelect\">\r\n              </el-table-column>\r\n              <el-table-column prop=\"sales\" label=\"成交额(元)\" align=\"center\" v-if=\"!isSelect\">\r\n              </el-table-column>\r\n            </el-table>\r\n          </div>\r\n\r\n        </div>\r\n        <div class=\"grid-content bg-purple bottom\" v-if=\"hasAuth('sys:orders:one')\">\r\n          <div class=\"select\">\r\n            <span style=\"font-size: 20px;margin-right: 380px;\">\r\n              <strong>商品热度排行榜</strong></span>\r\n              <span style=\"margin-right:10px;margin-top:5px\">商家编号</span>\r\n          <el-select style=\"margin-top:5px;margin-right:5px\" v-model=\"value2\" placeholder=\"请选择\" @change=\"getRankGoods(value2)\">\r\n            <el-option v-for=\"item in options\" :key=\"item.value2\" :label=\"item.label\" :value=\"item.value2\">\r\n            </el-option>\r\n          </el-select>\r\n          </div>\r\n          <div style=\"padding:20px 30px;box-sizing:border-box\">\r\n            <el-table :data=\"tableData\" style=\"width: 100%;\" ref=\"table\">\r\n              <el-table-column prop=\"rank\" label=\"排行\" width=\"100\" align=\"center\">\r\n              </el-table-column>\r\n              <el-table-column prop=\"goodsId\" label=\"商品编号\" width=\"250\" align=\"center\">\r\n              </el-table-column>\r\n              <el-table-column prop=\"goodsName\" label=\"商品名称\" width=\"250\" align=\"center\">\r\n              </el-table-column>\r\n              <el-table-column prop=\"quantity\" label=\"商品销量(份)\" width=\"200\" align=\"center\" sortable>\r\n              </el-table-column>\r\n              <el-table-column prop=\"sales\" label=\"销售额(元)\" align=\"center\" sortable>\r\n              </el-table-column>\r\n            </el-table>\r\n          </div>\r\n\r\n        </div>\r\n      </el-col>\r\n\r\n    </el-row>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  data() {\r\n    return {\r\n      user: {\r\n        username: '',\r\n        avatar: '',\r\n        email: '',\r\n        tel: ''\r\n      },\r\n      businessIds:[],\r\n      businessCount: '',\r\n      userCount: '',\r\n      accountCount: '',\r\n      allOrdersCount: '',\r\n      tableData: [],\r\n      value: 'count',\r\n      value2:'',\r\n      isSelect: true,\r\n      timeRange: 'ONE_MONTH',\r\n      options: [\r\n        {\r\n          value:'count',\r\n          label:'销售量(单)'\r\n        },\r\n        {\r\n          value:'sales',\r\n          label:'销售额(元)'\r\n        }\r\n      ],\r\n      isRank:false\r\n    }\r\n  },\r\n  watch: {\r\n    timeRange(newValue) {\r\n      this.getRankList(this.value, newValue)\r\n      setTimeout(() => {\r\n        this.$refs.table.doLayout(); // 手动重新渲染table\r\n      }, 0);\r\n    },\r\n  },\r\n  created() {\r\n    this.getUserInfo();\r\n    if(this.businessIds.length==0){\r\n      this.getRankList(this.value, this.timeRange); \r\n    }\r\n    this.getBusinessCount();\r\n    this.getAccountCount();\r\n    this.getUserCount();\r\n    this.getAllOrdersCount();\r\n    \r\n    \r\n  },\r\n  methods: {\r\n    getUserInfo() {\r\n      //请求服务器获得\r\n      this.$axios.get('/api/userinfo').then(response => {\r\n        this.user = response.data.resultdata\r\n        if(response.data.resultdata.business.length>0){\r\n          this.businessIds = response.data.resultdata.business\r\n        this.value2 = this.businessIds[0].businessId;\r\n        this.getRankGoods(this.value2);\r\n        this.businessIds.forEach((b,index)=>{\r\n        this.options[index] = {\r\n          value2:b.businessId,\r\n          label:b.businessId\r\n        }\r\n      })\r\n        }\r\n          \r\n      }).catch(e => {\r\n        console.log(e);\r\n      })\r\n    },\r\n    getBusinessCount() {\r\n      this.$axios.get('/business/count').then(response => {\r\n        this.businessCount = response.data.resultdata\r\n      }).catch(e => {\r\n        console.log(e);\r\n      })\r\n    },\r\n    getUserCount() {\r\n      this.$axios.get('/user/count').then(response => {\r\n        this.userCount = response.data.resultdata\r\n      }).catch(e => {\r\n        console.log(e);\r\n      })\r\n    },\r\n    getAccountCount() {\r\n      this.$axios.get('/account/count').then(response => {\r\n        this.accountCount = response.data.resultdata\r\n      }).catch(e => {\r\n        console.log(e);\r\n      })\r\n    },\r\n    getAllOrdersCount() {\r\n      this.$axios.get('/orders/allcount').then(response => {\r\n        this.allOrdersCount = response.data.resultdata\r\n      }).catch(e => {\r\n        console.log(e);\r\n      })\r\n    },\r\n    getRankGoods(id){\r\n \r\n      this.$axios.get('/orders/rank/' + id).then(response => {\r\n        this.tableData = response.data.resultdata.map((item, index) => {\r\n          return {\r\n            goodsId: item.goodsId,\r\n            goodsName: item.goodsName,\r\n            quantity: item.quantity,\r\n            sales: item.sales,\r\n            rank: index + 1\r\n          }\r\n        })\r\n        this.$forceUpdate();\r\n      }).catch(e => {\r\n        console.log(e);\r\n      })\r\n    },\r\n    getRankList(val, timeRange) {\r\n      if (val == \"count\") {\r\n        this.isSelect = true\r\n      }\r\n      if (val == \"sales\") {\r\n        this.isSelect = false\r\n      }\r\n      this.$axios.get('/orders/' + val + '/' + timeRange).then(response => {\r\n        this.tableData = response.data.resultdata.map((item, index) => {\r\n          return {\r\n            created: item.created,\r\n            businessName: item.businessName,\r\n            businessExplain: item.businessExplain,\r\n            ordersCount: item.ordersCount,\r\n            sales: item.sales,\r\n            rank: index + 1\r\n          }\r\n        })\r\n        this.$forceUpdate();\r\n      }).catch(e => {\r\n        console.log(e);\r\n      })\r\n    },\r\n    formatDate(row, column) {\r\n      return new Date(row.created).toLocaleDateString();\r\n    }\r\n  },\r\n}\r\n\r\n</script>\r\n<style scoped>\r\n.page {\r\n  height: 100%\r\n}\r\n\r\n.el-row {\r\n  &:last-child {\r\n    margin-bottom: 0;\r\n  }\r\n}\r\n\r\n.el-col {\r\n  border-radius: 4px;\r\n}\r\n\r\n.bg-purple-dark {\r\n  background: #ffffff;\r\n}\r\n\r\n.bg-purple {\r\n  background: #ffffff;\r\n  margin: 5px 4px;\r\n}\r\n\r\n.bg-purple-light {\r\n  background: #ffffff;\r\n}\r\n\r\n.grid-content {\r\n  border-radius: 4px;\r\n  min-height: 36px;\r\n  box-shadow: 0 0 6px 0 #e0e0e0;\r\n}\r\n\r\n.row-bg {\r\n  padding: 10px 0;\r\n  background-color: #f9fafc;\r\n}\r\n\r\n.top {\r\n  height: 160px;\r\n  background-color: #ffffff;\r\n}\r\n\r\n.content {\r\n  height: 70px;\r\n  margin-bottom: 15px;\r\n}\r\n\r\n.el-main {\r\n  padding: 0;\r\n  overflow: hidden;\r\n}\r\n\r\n.top img {\r\n  width: 80px;\r\n  height: 80px;\r\n  border-radius: 10px;\r\n  margin: 20px;\r\n}\r\n\r\n.userInfo {\r\n  font-size: 16px;\r\n  margin-left: 15px;\r\n}\r\n\r\n.userInfo div {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  margin-bottom: 5px;\r\n}\r\n\r\n.bottom {\r\n  height: 600px\r\n}\r\n\r\n.select{\r\n  float: right;\r\n  display: flex;align-items: center;\r\n}\r\n.el-select {\r\n  margin-right: 10px;\r\n}\r\n\r\n.right {\r\n  background-color: #6cb5ff\r\n}\r\n\r\n.right div {\r\n  display: flex;\r\n  flex-direction: column;\r\n  padding: 10px;\r\n  box-sizing: border-box;\r\n  margin-left: 5px;\r\n}\r\n\r\n.right div .num {\r\n  font-size: 20px;\r\n  margin-bottom: 2px;\r\n  color: #ffffff;\r\n}\r\n\r\n.right div .text {\r\n  color: #f9f9f9;\r\n}\r\n.el-radio-group{\r\n  margin-top: 30px;\r\n  margin-right: 10px;\r\n}\r\n</style>"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}